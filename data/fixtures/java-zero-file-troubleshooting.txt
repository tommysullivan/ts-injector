cucumber.js --require features --tags @prepareInstallationReadySnapshot
Feature: Hardware Maintenance

  As a Spyglass Contributor
  In order to manage and debug known, reproducible environments for dev and testing purposes
  I can create, destroy, and inspect ESXI-based cluster snapshots

  @prepareInstallationReadySnapshot
  Scenario: Create "installationReady" snapshot for CentOS 6.5
    Given the Cluster Under Test is managed by ESXI
    And the Operating Systems of each node match what is configured
vim-cmd vmsvc/snapshot.revert 3 1 0
vim-cmd vmsvc/snapshot.revert 4 1 0
vim-cmd vmsvc/snapshot.revert 5 1 0
vim-cmd vmsvc/power.on 3
vim-cmd vmsvc/power.on 4
vim-cmd vmsvc/power.on 5
    Given I revert the cluster to its configured "baseImage" state
    And I wait "30" seconds
yum clean all
yum clean all
yum clean all
    And I have updated the package manager
yum install -y curl
yum install -y curl
yum install -y curl
    And I use the package manager to install the "curl" package
yum install -y java-1.7.0-openjdk
yum install -y java-1.7.0-openjdk
yum install -y java-1.7.0-openjdk
    And I have installed Java
    And I wait "10" seconds
vim-cmd vmsvc/power.off 3
vim-cmd vmsvc/power.off 4
vim-cmd vmsvc/power.off 5
    And I power off each node in the cluster
vim-cmd vmsvc/snapshot.create 3 readyForInstallation
vim-cmd vmsvc/snapshot.create 4 readyForInstallation
vim-cmd vmsvc/snapshot.create 5 readyForInstallation
vim-cmd vmsvc/get.snapshotinfo 4
vim-cmd vmsvc/get.snapshotinfo 3
vim-cmd vmsvc/get.snapshotinfo 5
    Then I take "readyForInstallation" snapshots of each node in the cluster
    And I manually retrieve the ids of these new snapshots based on the console output of the previous step
    And I manually update the configured "readyForInstallation" state for the cluster with the snapshot ids

1 scenario (1 passed)
12 steps (12 passed)
1m37.607s
TSULLIVAN-E496-MBR13:private-spyglass tsullivan$ bin/spyglass-tester cluster snapshot info for centos6.5
vim-cmd vmsvc/get.snapshotinfo 3
vim-cmd vmsvc/get.snapshotinfo 4
vim-cmd vmsvc/get.snapshotinfo 5
[
   {
      "host": "10.10.99.70",
      "processResult": {
         "command": "vim-cmd vmsvc/get.snapshotinfo 3",
         "processExitCode": 0,
         "stdoutLines": [
            "(vim.vm.SnapshotInfo) {",
            "   currentSnapshot = 'vim.vm.Snapshot:3-snapshot-8', ",
            "   rootSnapshotList = (vim.vm.SnapshotTree) [",
            "      (vim.vm.SnapshotTree) {",
            "         snapshot = 'vim.vm.Snapshot:3-snapshot-1', ",
            "         vm = 'vim.VirtualMachine:3', ",
            "         name = \"scale-72_base_snapshot\", ",
            "         description = \"\", ",
            "         id = 1, ",
            "         createTime = \"2016-03-10T02:49:07.84185Z\", ",
            "         state = \"poweredOff\", ",
            "         quiesced = false, ",
            "         backupManifest = <unset>, ",
            "         childSnapshotList = (vim.vm.SnapshotTree) [",
            "            (vim.vm.SnapshotTree) {",
            "               snapshot = 'vim.vm.Snapshot:3-snapshot-7', ",
            "               vm = 'vim.VirtualMachine:3', ",
            "               name = \"readyForInstallation\", ",
            "               description = \"\", ",
            "               id = 7, ",
            "               createTime = \"2016-05-19T21:53:00.169983Z\", ",
            "               state = \"poweredOff\", ",
            "               quiesced = false, ",
            "               backupManifest = <unset>, ",
            "               replaySupported = false, ",
            "            }, ",
            "            (vim.vm.SnapshotTree) {",
            "               snapshot = 'vim.vm.Snapshot:3-snapshot-8', ",
            "               vm = 'vim.VirtualMachine:3', ",
            "               name = \"readyForInstallation\", ",
            "               description = \"\", ",
            "               id = 8, ",
            "               createTime = \"2016-05-20T00:35:56.036955Z\", ",
            "               state = \"poweredOff\", ",
            "               quiesced = false, ",
            "               backupManifest = <unset>, ",
            "               replaySupported = false, ",
            "            }",
            "         ], ",
            "         replaySupported = false",
            "      }",
            "   ]",
            "}",
            ""
         ],
         "stderrLines": [
            ""
         ],
         "shellInvocationError": null
      }
   },
   {
      "host": "10.10.99.70",
      "processResult": {
         "command": "vim-cmd vmsvc/get.snapshotinfo 4",
         "processExitCode": 0,
         "stdoutLines": [
            "(vim.vm.SnapshotInfo) {",
            "   currentSnapshot = 'vim.vm.Snapshot:4-snapshot-8', ",
            "   rootSnapshotList = (vim.vm.SnapshotTree) [",
            "      (vim.vm.SnapshotTree) {",
            "         snapshot = 'vim.vm.Snapshot:4-snapshot-1', ",
            "         vm = 'vim.VirtualMachine:4', ",
            "         name = \"scale-73_base_snapshot\", ",
            "         description = \"\", ",
            "         id = 1, ",
            "         createTime = \"2016-03-10T02:49:59.79509Z\", ",
            "         state = \"poweredOff\", ",
            "         quiesced = false, ",
            "         backupManifest = <unset>, ",
            "         childSnapshotList = (vim.vm.SnapshotTree) [",
            "            (vim.vm.SnapshotTree) {",
            "               snapshot = 'vim.vm.Snapshot:4-snapshot-7', ",
            "               vm = 'vim.VirtualMachine:4', ",
            "               name = \"readyForInstallation\", ",
            "               description = \"\", ",
            "               id = 7, ",
            "               createTime = \"2016-05-19T21:53:00.147784Z\", ",
            "               state = \"poweredOff\", ",
            "               quiesced = false, ",
            "               backupManifest = <unset>, ",
            "               replaySupported = false, ",
            "            }, ",
            "            (vim.vm.SnapshotTree) {",
            "               snapshot = 'vim.vm.Snapshot:4-snapshot-8', ",
            "               vm = 'vim.VirtualMachine:4', ",
            "               name = \"readyForInstallation\", ",
            "               description = \"\", ",
            "               id = 8, ",
            "               createTime = \"2016-05-20T00:35:56.146073Z\", ",
            "               state = \"poweredOff\", ",
            "               quiesced = false, ",
            "               backupManifest = <unset>, ",
            "               replaySupported = false, ",
            "            }",
            "         ], ",
            "         replaySupported = false",
            "      }",
            "   ]",
            "}",
            ""
         ],
         "stderrLines": [
            ""
         ],
         "shellInvocationError": null
      }
   },
   {
      "host": "10.10.99.70",
      "processResult": {
         "command": "vim-cmd vmsvc/get.snapshotinfo 5",
         "processExitCode": 0,
         "stdoutLines": [
            "(vim.vm.SnapshotInfo) {",
            "   currentSnapshot = 'vim.vm.Snapshot:5-snapshot-8', ",
            "   rootSnapshotList = (vim.vm.SnapshotTree) [",
            "      (vim.vm.SnapshotTree) {",
            "         snapshot = 'vim.vm.Snapshot:5-snapshot-1', ",
            "         vm = 'vim.VirtualMachine:5', ",
            "         name = \"scale-74_base_snapshot\", ",
            "         description = \"\", ",
            "         id = 1, ",
            "         createTime = \"2016-03-10T02:50:19.018273Z\", ",
            "         state = \"poweredOff\", ",
            "         quiesced = false, ",
            "         backupManifest = <unset>, ",
            "         childSnapshotList = (vim.vm.SnapshotTree) [",
            "            (vim.vm.SnapshotTree) {",
            "               snapshot = 'vim.vm.Snapshot:5-snapshot-7', ",
            "               vm = 'vim.VirtualMachine:5', ",
            "               name = \"readyForInstallation\", ",
            "               description = \"\", ",
            "               id = 7, ",
            "               createTime = \"2016-05-19T21:53:00.175717Z\", ",
            "               state = \"poweredOff\", ",
            "               quiesced = false, ",
            "               backupManifest = <unset>, ",
            "               replaySupported = false, ",
            "            }, ",
            "            (vim.vm.SnapshotTree) {",
            "               snapshot = 'vim.vm.Snapshot:5-snapshot-8', ",
            "               vm = 'vim.VirtualMachine:5', ",
            "               name = \"readyForInstallation\", ",
            "               description = \"\", ",
            "               id = 8, ",
            "               createTime = \"2016-05-20T00:35:56.186823Z\", ",
            "               state = \"poweredOff\", ",
            "               quiesced = false, ",
            "               backupManifest = <unset>, ",
            "               replaySupported = false, ",
            "            }",
            "         ], ",
            "         replaySupported = false",
            "      }",
            "   ]",
            "}",
            ""
         ],
         "stderrLines": [
            ""
         ],
         "shellInvocationError": null
      }
   }
]
TSULLIVAN-E496-MBR13:private-spyglass tsullivan$ bin/spyglass-tester cluster power on

Usage:
/Users/tsullivan/projects/private-spyglass/bin/spyglass-tester cluster [subCommand]

subCommands                            description
-----------                            -----------
ids                                    list available cluster ids
hosting [hostName]                     yields cluster ids containing specified host
config for [clusterId]                 yields configuration for specified cluster
versions for [clusterId]               yields package / os version info for specified cluster
snapshot [action]                      manage snapshot / state of cluster
power [on|off|reset] [clusterId]       reset cluster power or turn it off or on

Usage:
/Users/tsullivan/projects/private-spyglass/bin/spyglass-tester [command] [command specific arguments]

commands                  description
--------                  -----------
run                       execute some tests
tags                      list available cucumber tags
featureSets [in detail]   list runnable featureSets, optionally "in detail"
cluster                   manage the cluster under test
server [with jira]        run the server (if words "with jira" are present, you will be prompted for creds)

Expected command line argument "clusterId" in position 5 but it was not found
TSULLIVAN-E496-MBR13:private-spyglass tsullivan$ bin/spyglass-tester cluster power on centos6.5
vim-cmd vmsvc/power.on 3
vim-cmd vmsvc/power.on 4
vim-cmd vmsvc/power.on 5
[
   {
      "host": "10.10.99.70",
      "processResult": {
         "command": "vim-cmd vmsvc/power.on 3",
         "processExitCode": 0,
         "stdoutLines": [
            "Powering on VM:",
            ""
         ],
         "stderrLines": [
            ""
         ],
         "shellInvocationError": null
      }
   },
   {
      "host": "10.10.99.70",
      "processResult": {
         "command": "vim-cmd vmsvc/power.on 4",
         "processExitCode": 0,
         "stdoutLines": [
            "Powering on VM:",
            ""
         ],
         "stderrLines": [
            ""
         ],
         "shellInvocationError": null
      }
   },
   {
      "host": "10.10.99.70",
      "processResult": {
         "command": "vim-cmd vmsvc/power.on 5",
         "processExitCode": 0,
         "stdoutLines": [
            "Powering on VM:",
            ""
         ],
         "stderrLines": [
            ""
         ],
         "shellInvocationError": null
      }
   }
]
TSULLIVAN-E496-MBR13:private-spyglass tsullivan$ ssh root@10.10.99.72
^C
TSULLIVAN-E496-MBR13:private-spyglass tsullivan$ ssh root@10.10.99.72
^C
TSULLIVAN-E496-MBR13:private-spyglass tsullivan$ ssh root@10.10.99.72
ssh: connect to host 10.10.99.72 port 22: Connection refused
TSULLIVAN-E496-MBR13:private-spyglass tsullivan$ ssh root@10.10.99.72
ssh: connect to host 10.10.99.72 port 22: Connection refused
TSULLIVAN-E496-MBR13:private-spyglass tsullivan$ ssh root@10.10.99.72
ssh: connect to host 10.10.99.72 port 22: Connection refused
TSULLIVAN-E496-MBR13:private-spyglass tsullivan$ ssh root@10.10.99.72
root@10.10.99.72's password:
Last login: Wed Mar  9 18:44:20 2016
[root@scale-72 ~]# java
[root@scale-72 ~]# exit
logout
Connection to 10.10.99.72 closed.
TSULLIVAN-E496-MBR13:private-spyglass tsullivan$ cucumber.js --require features --tags @prepareInstallationReadySnapshot
Feature: Hardware Maintenance

  As a Spyglass Contributor
  In order to manage and debug known, reproducible environments for dev and testing purposes
  I can create, destroy, and inspect ESXI-based cluster snapshots

  @prepareInstallationReadySnapshot
  Scenario: Create "installationReady" snapshot for CentOS 6.5
    Given the Cluster Under Test is managed by ESXI
    And the Operating Systems of each node match what is configured
vim-cmd vmsvc/snapshot.revert 3 1 0
vim-cmd vmsvc/snapshot.revert 4 1 0
vim-cmd vmsvc/snapshot.revert 5 1 0
vim-cmd vmsvc/power.on 3
vim-cmd vmsvc/power.on 4
vim-cmd vmsvc/power.on 5
    Given I revert the cluster to its configured "baseImage" state
    And I wait "30" seconds
yum clean all
yum clean all
yum clean all
    And I have updated the package manager
yum install -y curl
yum install -y curl
yum install -y curl
    And I use the package manager to install the "curl" package
yum install -y java-1.7.0-openjdk
yum install -y java-1.7.0-openjdk
yum install -y java-1.7.0-openjdk
    And I have installed Java
    And I manually retrieve the ids of these new snapshots based on the console output of the previous step
    And I manually update the configured "readyForInstallation" state for the cluster with the snapshot ids

1 scenario (1 passed)
9 steps (9 passed)
1m09.792s
TSULLIVAN-E496-MBR13:private-spyglass tsullivan$ cucumber.js --require features --tags @prepareInstallationReadySnapshot
Feature: Hardware Maintenance

  As a Spyglass Contributor
  In order to manage and debug known, reproducible environments for dev and testing purposes
  I can create, destroy, and inspect ESXI-based cluster snapshots

  @prepareInstallationReadySnapshot
  Scenario: Create "installationReady" snapshot for CentOS 6.5
    Given the Cluster Under Test is managed by ESXI
    And the Operating Systems of each node match what is configured
vim-cmd vmsvc/snapshot.revert 3 1 0
vim-cmd vmsvc/snapshot.revert 4 1 0
vim-cmd vmsvc/snapshot.revert 5 1 0
vim-cmd vmsvc/power.on 3
vim-cmd vmsvc/power.on 4
vim-cmd vmsvc/power.on 5
    Given I revert the cluster to its configured "baseImage" state
    And I wait "30" seconds
yum clean all
yum clean all
yum clean all
    And I have updated the package manager
yum install -y curl
yum install -y curl
yum install -y curl
    And I use the package manager to install the "curl" package
yum install -y java-1.7.0-openjdk
yum install -y java-1.7.0-openjdk
yum install -y java-1.7.0-openjdk
    And I have installed Java
    And I manually retrieve the ids of these new snapshots based on the console output of the previous step
    And I manually update the configured "readyForInstallation" state for the cluster with the snapshot ids

1 scenario (1 passed)
9 steps (9 passed)
1m09.355s
TSULLIVAN-E496-MBR13:private-spyglass tsullivan$ ssh root@10.10.99.72
root@10.10.99.72's password:
Last login: Wed Mar  9 18:44:20 2016
[root@scale-72 ~]# java
Usage: java [-options] class [args...]
           (to execute a class)
   or  java [-options] -jar jarfile [args...]
           (to execute a jar file)
where options include:
    -d32          use a 32-bit data model if available
    -d64          use a 64-bit data model if available
    -server       to select the "server" VM
                  The default VM is server,
                  because you are running on a server-class machine.


    -cp <class search path of directories and zip/jar files>
    -classpath <class search path of directories and zip/jar files>
                  A : separated list of directories, JAR archives,
                  and ZIP archives to search for class files.
    -D<name>=<value>
                  set a system property
    -verbose:[class|gc|jni]
                  enable verbose output
    -version      print product version and exit
    -version:<value>
                  require the specified version to run
    -showversion  print product version and continue
    -jre-restrict-search | -no-jre-restrict-search
                  include/exclude user private JREs in the version search
    -? -help      print this help message
    -X            print help on non-standard options
    -ea[:<packagename>...|:<classname>]
    -enableassertions[:<packagename>...|:<classname>]
                  enable assertions with specified granularity
    -da[:<packagename>...|:<classname>]
    -disableassertions[:<packagename>...|:<classname>]
                  disable assertions with specified granularity
    -esa | -enablesystemassertions
                  enable system assertions
    -dsa | -disablesystemassertions
                  disable system assertions
    -agentlib:<libname>[=<options>]
                  load native agent library <libname>, e.g. -agentlib:hprof
                  see also, -agentlib:jdwp=help and -agentlib:hprof=help
    -agentpath:<pathname>[=<options>]
                  load native agent library by full pathname
    -javaagent:<jarpath>[=<options>]
                  load Java programming language agent, see java.lang.instrument
    -splash:<imagepath>
                  show splash screen with specified image
See http://www.oracle.com/technetwork/java/javase/documentation/index.html for more details.
[root@scale-72 ~]# yum info java
Loaded plugins: fastestmirror, security
Loading mirror speeds from cached hostfile
 * base: repo1.sea.innoscale.net
 * epel: mirrors.kernel.org
 * extras: mirror.supremebytes.com
 * updates: centos-distro.1gservers.com
Error: No matching Packages to list
[root@scale-72 ~]# which java
/usr/bin/java
[root@scale-72 ~]# ls /usr/bin/java
/usr/bin/java
[root@scale-72 ~]# ls -al /usr/bin/java
lrwxrwxrwx 1 root root 22 May 19 17:44 /usr/bin/java -> /etc/alternatives/java
[root@scale-72 ~]# ls -al /etc/alternatives/java
lrwxrwxrwx 1 root root 46 May 19 17:44 /etc/alternatives/java -> /usr/lib/jvm/jre-1.7.0-openjdk.x86_64/bin/java
[root@scale-72 ~]# ls -al /usr/lib/jvm/jre-1.7.0-openjdk.x86_64/bin/java
-rwxr-xr-x 1 root root 5352 Apr 21 06:51 /usr/lib/jvm/jre-1.7.0-openjdk.x86_64/bin/java
[root@scale-72 ~]# reboot

Broadcast message from root@scale-72.scale.lab
        (/dev/pts/0) at 17:46 ...

The system is going down for reboot NOW!
[root@scale-72 ~]# Connection to 10.10.99.72 closed by remote host.
Connection to 10.10.99.72 closed.
TSULLIVAN-E496-MBR13:private-spyglass tsullivan$ ssh root@10.10.99.72
root@10.10.99.72's password:
Last login: Thu May 19 17:44:38 2016 from 172.30.1.208
[root@scale-72 ~]# ls -al /usr/lib/jvm/jre-1.7.0-openjdk.x86_64/bin/java
-rwxr-xr-x 1 root root 5352 Apr 21 06:51 /usr/lib/jvm/jre-1.7.0-openjdk.x86_64/bin/java
[root@scale-72 ~]# java
Usage: java [-options] class [args...]
           (to execute a class)
   or  java [-options] -jar jarfile [args...]
           (to execute a jar file)
where options include:
    -d32          use a 32-bit data model if available
    -d64          use a 64-bit data model if available
    -server       to select the "server" VM
                  The default VM is server,
                  because you are running on a server-class machine.


    -cp <class search path of directories and zip/jar files>
    -classpath <class search path of directories and zip/jar files>
                  A : separated list of directories, JAR archives,
                  and ZIP archives to search for class files.
    -D<name>=<value>
                  set a system property
    -verbose:[class|gc|jni]
                  enable verbose output
    -version      print product version and exit
    -version:<value>
                  require the specified version to run
    -showversion  print product version and continue
    -jre-restrict-search | -no-jre-restrict-search
                  include/exclude user private JREs in the version search
    -? -help      print this help message
    -X            print help on non-standard options
    -ea[:<packagename>...|:<classname>]
    -enableassertions[:<packagename>...|:<classname>]
                  enable assertions with specified granularity
    -da[:<packagename>...|:<classname>]
    -disableassertions[:<packagename>...|:<classname>]
                  disable assertions with specified granularity
    -esa | -enablesystemassertions
                  enable system assertions
    -dsa | -disablesystemassertions
                  disable system assertions
    -agentlib:<libname>[=<options>]
                  load native agent library <libname>, e.g. -agentlib:hprof
                  see also, -agentlib:jdwp=help and -agentlib:hprof=help
    -agentpath:<pathname>[=<options>]
                  load native agent library by full pathname
    -javaagent:<jarpath>[=<options>]
                  load Java programming language agent, see java.lang.instrument
    -splash:<imagepath>
                  show splash screen with specified image
See http://www.oracle.com/technetwork/java/javase/documentation/index.html for more details.
[root@scale-72 ~]# exit
logout
Connection to 10.10.99.72 closed.
TSULLIVAN-E496-MBR13:private-spyglass tsullivan$ bin/spyglass-tester cluster power reset centos6.5
vim-cmd vmsvc/power.off 3
vim-cmd vmsvc/power.off 4
vim-cmd vmsvc/power.off 5
vim-cmd vmsvc/power.on 5
vim-cmd vmsvc/power.on 3
vim-cmd vmsvc/power.on 4
[
   [
      {
         "host": "10.10.99.70",
         "processResult": {
            "command": "vim-cmd vmsvc/power.off 3",
            "processExitCode": 0,
            "stdoutLines": [
               "Powering off VM:",
               ""
            ],
            "stderrLines": [
               ""
            ],
            "shellInvocationError": null
         }
      },
      {
         "host": "10.10.99.70",
         "processResult": {
            "command": "vim-cmd vmsvc/power.on 3",
            "processExitCode": 0,
            "stdoutLines": [
               "Powering on VM:",
               ""
            ],
            "stderrLines": [
               ""
            ],
            "shellInvocationError": null
         }
      }
   ],
   [
      {
         "host": "10.10.99.70",
         "processResult": {
            "command": "vim-cmd vmsvc/power.off 4",
            "processExitCode": 0,
            "stdoutLines": [
               "Powering off VM:",
               ""
            ],
            "stderrLines": [
               ""
            ],
            "shellInvocationError": null
         }
      },
      {
         "host": "10.10.99.70",
         "processResult": {
            "command": "vim-cmd vmsvc/power.on 4",
            "processExitCode": 0,
            "stdoutLines": [
               "Powering on VM:",
               ""
            ],
            "stderrLines": [
               ""
            ],
            "shellInvocationError": null
         }
      }
   ],
   [
      {
         "host": "10.10.99.70",
         "processResult": {
            "command": "vim-cmd vmsvc/power.off 5",
            "processExitCode": 0,
            "stdoutLines": [
               "Powering off VM:",
               ""
            ],
            "stderrLines": [
               ""
            ],
            "shellInvocationError": null
         }
      },
      {
         "host": "10.10.99.70",
         "processResult": {
            "command": "vim-cmd vmsvc/power.on 5",
            "processExitCode": 0,
            "stdoutLines": [
               "Powering on VM:",
               ""
            ],
            "stderrLines": [
               ""
            ],
            "shellInvocationError": null
         }
      }
   ]
]
TSULLIVAN-E496-MBR13:private-spyglass tsullivan$ ssh root@10.10.99.72
ssh: connect to host 10.10.99.72 port 22: Connection refused
TSULLIVAN-E496-MBR13:private-spyglass tsullivan$ ssh root@10.10.99.72
ssh: connect to host 10.10.99.72 port 22: Connection refused
TSULLIVAN-E496-MBR13:private-spyglass tsullivan$ ssh root@10.10.99.72
root@10.10.99.72's password:
Last login: Thu May 19 17:47:23 2016 from 172.30.1.208
[root@scale-72 ~]# ls -al /usr/lib/jvm/jre-1.7.0-openjdk.x86_64/bin/java
-rwxr-xr-x 1 root root 5352 Apr 21 06:51 /usr/lib/jvm/jre-1.7.0-openjdk.x86_64/bin/java
[root@scale-72 ~]# exit
logout
Connection to 10.10.99.72 closed.
TSULLIVAN-E496-MBR13:private-spyglass tsullivan$ bin/spyglass-tester cluster snapshot capture "javaInstalled" from centos6.5
vim-cmd vmsvc/snapshot.create 3 javaInstalled
vim-cmd vmsvc/snapshot.create 4 javaInstalled
vim-cmd vmsvc/snapshot.create 5 javaInstalled
vim-cmd vmsvc/get.snapshotinfo 3
vim-cmd vmsvc/get.snapshotinfo 4
vim-cmd vmsvc/get.snapshotinfo 5
[
   [
      {
         "host": "10.10.99.70",
         "processResult": {
            "command": "vim-cmd vmsvc/snapshot.create 3 javaInstalled",
            "processExitCode": 0,
            "stdoutLines": [
               "Create Snapshot:",
               ""
            ],
            "stderrLines": [
               ""
            ],
            "shellInvocationError": null
         }
      },
      {
         "host": "10.10.99.70",
         "processResult": {
            "command": "vim-cmd vmsvc/get.snapshotinfo 3",
            "processExitCode": 0,
            "stdoutLines": [
               "(vim.vm.SnapshotInfo) {",
               "   currentSnapshot = 'vim.vm.Snapshot:3-snapshot-9', ",
               "   rootSnapshotList = (vim.vm.SnapshotTree) [",
               "      (vim.vm.SnapshotTree) {",
               "         snapshot = 'vim.vm.Snapshot:3-snapshot-1', ",
               "         vm = 'vim.VirtualMachine:3', ",
               "         name = \"scale-72_base_snapshot\", ",
               "         description = \"\", ",
               "         id = 1, ",
               "         createTime = \"2016-03-10T02:49:07.84185Z\", ",
               "         state = \"poweredOff\", ",
               "         quiesced = false, ",
               "         backupManifest = <unset>, ",
               "         childSnapshotList = (vim.vm.SnapshotTree) [",
               "            (vim.vm.SnapshotTree) {",
               "               snapshot = 'vim.vm.Snapshot:3-snapshot-7', ",
               "               vm = 'vim.VirtualMachine:3', ",
               "               name = \"readyForInstallation\", ",
               "               description = \"\", ",
               "               id = 7, ",
               "               createTime = \"2016-05-19T21:53:00.169983Z\", ",
               "               state = \"poweredOff\", ",
               "               quiesced = false, ",
               "               backupManifest = <unset>, ",
               "               replaySupported = false, ",
               "            }, ",
               "            (vim.vm.SnapshotTree) {",
               "               snapshot = 'vim.vm.Snapshot:3-snapshot-8', ",
               "               vm = 'vim.VirtualMachine:3', ",
               "               name = \"readyForInstallation\", ",
               "               description = \"\", ",
               "               id = 8, ",
               "               createTime = \"2016-05-20T00:35:56.036955Z\", ",
               "               state = \"poweredOff\", ",
               "               quiesced = false, ",
               "               backupManifest = <unset>, ",
               "               replaySupported = false, ",
               "            }, ",
               "            (vim.vm.SnapshotTree) {",
               "               snapshot = 'vim.vm.Snapshot:3-snapshot-9', ",
               "               vm = 'vim.VirtualMachine:3', ",
               "               name = \"javaInstalled\", ",
               "               description = \"\", ",
               "               id = 9, ",
               "               createTime = \"2016-05-20T00:48:27.422568Z\", ",
               "               state = \"poweredOff\", ",
               "               quiesced = false, ",
               "               backupManifest = <unset>, ",
               "               replaySupported = false, ",
               "            }",
               "         ], ",
               "         replaySupported = false",
               "      }",
               "   ]",
               "}",
               ""
            ],
            "stderrLines": [
               ""
            ],
            "shellInvocationError": null
         }
      }
   ],
   [
      {
         "host": "10.10.99.70",
         "processResult": {
            "command": "vim-cmd vmsvc/snapshot.create 4 javaInstalled",
            "processExitCode": 0,
            "stdoutLines": [
               "Create Snapshot:",
               ""
            ],
            "stderrLines": [
               ""
            ],
            "shellInvocationError": null
         }
      },
      {
         "host": "10.10.99.70",
         "processResult": {
            "command": "vim-cmd vmsvc/get.snapshotinfo 4",
            "processExitCode": 0,
            "stdoutLines": [
               "(vim.vm.SnapshotInfo) {",
               "   currentSnapshot = 'vim.vm.Snapshot:4-snapshot-9', ",
               "   rootSnapshotList = (vim.vm.SnapshotTree) [",
               "      (vim.vm.SnapshotTree) {",
               "         snapshot = 'vim.vm.Snapshot:4-snapshot-1', ",
               "         vm = 'vim.VirtualMachine:4', ",
               "         name = \"scale-73_base_snapshot\", ",
               "         description = \"\", ",
               "         id = 1, ",
               "         createTime = \"2016-03-10T02:49:59.79509Z\", ",
               "         state = \"poweredOff\", ",
               "         quiesced = false, ",
               "         backupManifest = <unset>, ",
               "         childSnapshotList = (vim.vm.SnapshotTree) [",
               "            (vim.vm.SnapshotTree) {",
               "               snapshot = 'vim.vm.Snapshot:4-snapshot-7', ",
               "               vm = 'vim.VirtualMachine:4', ",
               "               name = \"readyForInstallation\", ",
               "               description = \"\", ",
               "               id = 7, ",
               "               createTime = \"2016-05-19T21:53:00.147784Z\", ",
               "               state = \"poweredOff\", ",
               "               quiesced = false, ",
               "               backupManifest = <unset>, ",
               "               replaySupported = false, ",
               "            }, ",
               "            (vim.vm.SnapshotTree) {",
               "               snapshot = 'vim.vm.Snapshot:4-snapshot-8', ",
               "               vm = 'vim.VirtualMachine:4', ",
               "               name = \"readyForInstallation\", ",
               "               description = \"\", ",
               "               id = 8, ",
               "               createTime = \"2016-05-20T00:35:56.146073Z\", ",
               "               state = \"poweredOff\", ",
               "               quiesced = false, ",
               "               backupManifest = <unset>, ",
               "               replaySupported = false, ",
               "            }, ",
               "            (vim.vm.SnapshotTree) {",
               "               snapshot = 'vim.vm.Snapshot:4-snapshot-9', ",
               "               vm = 'vim.VirtualMachine:4', ",
               "               name = \"javaInstalled\", ",
               "               description = \"\", ",
               "               id = 9, ",
               "               createTime = \"2016-05-20T00:48:27.434889Z\", ",
               "               state = \"poweredOff\", ",
               "               quiesced = false, ",
               "               backupManifest = <unset>, ",
               "               replaySupported = false, ",
               "            }",
               "         ], ",
               "         replaySupported = false",
               "      }",
               "   ]",
               "}",
               ""
            ],
            "stderrLines": [
               ""
            ],
            "shellInvocationError": null
         }
      }
   ],
   [
      {
         "host": "10.10.99.70",
         "processResult": {
            "command": "vim-cmd vmsvc/snapshot.create 5 javaInstalled",
            "processExitCode": 0,
            "stdoutLines": [
               "Create Snapshot:",
               ""
            ],
            "stderrLines": [
               ""
            ],
            "shellInvocationError": null
         }
      },
      {
         "host": "10.10.99.70",
         "processResult": {
            "command": "vim-cmd vmsvc/get.snapshotinfo 5",
            "processExitCode": 0,
            "stdoutLines": [
               "(vim.vm.SnapshotInfo) {",
               "   currentSnapshot = 'vim.vm.Snapshot:5-snapshot-9', ",
               "   rootSnapshotList = (vim.vm.SnapshotTree) [",
               "      (vim.vm.SnapshotTree) {",
               "         snapshot = 'vim.vm.Snapshot:5-snapshot-1', ",
               "         vm = 'vim.VirtualMachine:5', ",
               "         name = \"scale-74_base_snapshot\", ",
               "         description = \"\", ",
               "         id = 1, ",
               "         createTime = \"2016-03-10T02:50:19.018273Z\", ",
               "         state = \"poweredOff\", ",
               "         quiesced = false, ",
               "         backupManifest = <unset>, ",
               "         childSnapshotList = (vim.vm.SnapshotTree) [",
               "            (vim.vm.SnapshotTree) {",
               "               snapshot = 'vim.vm.Snapshot:5-snapshot-7', ",
               "               vm = 'vim.VirtualMachine:5', ",
               "               name = \"readyForInstallation\", ",
               "               description = \"\", ",
               "               id = 7, ",
               "               createTime = \"2016-05-19T21:53:00.175717Z\", ",
               "               state = \"poweredOff\", ",
               "               quiesced = false, ",
               "               backupManifest = <unset>, ",
               "               replaySupported = false, ",
               "            }, ",
               "            (vim.vm.SnapshotTree) {",
               "               snapshot = 'vim.vm.Snapshot:5-snapshot-8', ",
               "               vm = 'vim.VirtualMachine:5', ",
               "               name = \"readyForInstallation\", ",
               "               description = \"\", ",
               "               id = 8, ",
               "               createTime = \"2016-05-20T00:35:56.186823Z\", ",
               "               state = \"poweredOff\", ",
               "               quiesced = false, ",
               "               backupManifest = <unset>, ",
               "               replaySupported = false, ",
               "            }, ",
               "            (vim.vm.SnapshotTree) {",
               "               snapshot = 'vim.vm.Snapshot:5-snapshot-9', ",
               "               vm = 'vim.VirtualMachine:5', ",
               "               name = \"javaInstalled\", ",
               "               description = \"\", ",
               "               id = 9, ",
               "               createTime = \"2016-05-20T00:48:27.40452Z\", ",
               "               state = \"poweredOff\", ",
               "               quiesced = false, ",
               "               backupManifest = <unset>, ",
               "               replaySupported = false, ",
               "            }",
               "         ], ",
               "         replaySupported = false",
               "      }",
               "   ]",
               "}",
               ""
            ],
            "stderrLines": [
               ""
            ],
            "shellInvocationError": null
         }
      }
   ]
]
TSULLIVAN-E496-MBR13:private-spyglass tsullivan$ bin/spyglass-tester cluster power on centos6.5
vim-cmd vmsvc/power.on 3
vim-cmd vmsvc/power.on 4
vim-cmd vmsvc/power.on 5
TSULLIVAN-E496-MBR13:private-spyglass tsullivan$ ssh root@10.10.99.72
root@10.10.99.72's password:
Last login: Thu May 19 17:46:44 2016 from 172.30.1.208
[root@scale-72 ~]# ls -al /usr/lib/jvm/jre-1.7.0-openjdk.x86_64/bin/java
-rwxr-xr-x 1 root root 5352 Apr 21 06:51 /usr/lib/jvm/jre-1.7.0-openjdk.x86_64/bin/java
[root@scale-72 ~]# java
Usage: java [-options] class [args...]
           (to execute a class)
   or  java [-options] -jar jarfile [args...]
           (to execute a jar file)
where options include:
    -d32          use a 32-bit data model if available
    -d64          use a 64-bit data model if available
    -server       to select the "server" VM
                  The default VM is server,
                  because you are running on a server-class machine.


    -cp <class search path of directories and zip/jar files>
    -classpath <class search path of directories and zip/jar files>
                  A : separated list of directories, JAR archives,
                  and ZIP archives to search for class files.
    -D<name>=<value>
                  set a system property
    -verbose:[class|gc|jni]
                  enable verbose output
    -version      print product version and exit
    -version:<value>
                  require the specified version to run
    -showversion  print product version and continue
    -jre-restrict-search | -no-jre-restrict-search
                  include/exclude user private JREs in the version search
    -? -help      print this help message
    -X            print help on non-standard options
    -ea[:<packagename>...|:<classname>]
    -enableassertions[:<packagename>...|:<classname>]
                  enable assertions with specified granularity
    -da[:<packagename>...|:<classname>]
    -disableassertions[:<packagename>...|:<classname>]
                  disable assertions with specified granularity
    -esa | -enablesystemassertions
                  enable system assertions
    -dsa | -disablesystemassertions
                  disable system assertions
    -agentlib:<libname>[=<options>]
                  load native agent library <libname>, e.g. -agentlib:hprof
                  see also, -agentlib:jdwp=help and -agentlib:hprof=help
    -agentpath:<pathname>[=<options>]
                  load native agent library by full pathname
    -javaagent:<jarpath>[=<options>]
                  load Java programming language agent, see java.lang.instrument
    -splash:<imagepath>
                  show splash screen with specified image
See http://www.oracle.com/technetwork/java/javase/documentation/index.html for more details.
[root@scale-72 ~]# exit
logout
Connection to 10.10.99.72 closed.
$ bin/spyglass-tester cluster snapshot info for centos6.5
vim-cmd vmsvc/get.snapshotinfo 3
vim-cmd vmsvc/get.snapshotinfo 4
vim-cmd vmsvc/get.snapshotinfo 5
[
   {
      "host": "10.10.99.70",
      "processResult": {
         "command": "vim-cmd vmsvc/get.snapshotinfo 3",
         "processExitCode": 0,
         "stdoutLines": [
            "(vim.vm.SnapshotInfo) {",
            "   currentSnapshot = 'vim.vm.Snapshot:3-snapshot-9', ",
            "   rootSnapshotList = (vim.vm.SnapshotTree) [",
            "      (vim.vm.SnapshotTree) {",
            "         snapshot = 'vim.vm.Snapshot:3-snapshot-1', ",
            "         vm = 'vim.VirtualMachine:3', ",
            "         name = \"scale-72_base_snapshot\", ",
            "         description = \"\", ",
            "         id = 1, ",
            "         createTime = \"2016-03-10T02:49:07.84185Z\", ",
            "         state = \"poweredOff\", ",
            "         quiesced = false, ",
            "         backupManifest = <unset>, ",
            "         childSnapshotList = (vim.vm.SnapshotTree) [",
            "            (vim.vm.SnapshotTree) {",
            "               snapshot = 'vim.vm.Snapshot:3-snapshot-7', ",
            "               vm = 'vim.VirtualMachine:3', ",
            "               name = \"readyForInstallation\", ",
            "               description = \"\", ",
            "               id = 7, ",
            "               createTime = \"2016-05-19T21:53:00.169983Z\", ",
            "               state = \"poweredOff\", ",
            "               quiesced = false, ",
            "               backupManifest = <unset>, ",
            "               replaySupported = false, ",
            "            }, ",
            "            (vim.vm.SnapshotTree) {",
            "               snapshot = 'vim.vm.Snapshot:3-snapshot-8', ",
            "               vm = 'vim.VirtualMachine:3', ",
            "               name = \"readyForInstallation\", ",
            "               description = \"\", ",
            "               id = 8, ",
            "               createTime = \"2016-05-20T00:35:56.036955Z\", ",
            "               state = \"poweredOff\", ",
            "               quiesced = false, ",
            "               backupManifest = <unset>, ",
            "               replaySupported = false, ",
            "            }, ",
            "            (vim.vm.SnapshotTree) {",
            "               snapshot = 'vim.vm.Snapshot:3-snapshot-9', ",
            "               vm = 'vim.VirtualMachine:3', ",
            "               name = \"javaInstalled\", ",
            "               description = \"\", ",
            "               id = 9, ",
            "               createTime = \"2016-05-20T00:48:27.422568Z\", ",
            "               state = \"poweredOff\", ",
            "               quiesced = false, ",
            "               backupManifest = <unset>, ",
            "               replaySupported = false, ",
            "            }",
            "         ], ",
            "         replaySupported = false",
            "      }",
            "   ]",
            "}",
            ""
         ],
         "stderrLines": [
            ""
         ],
         "shellInvocationError": null
      }
   },
   {
      "host": "10.10.99.70",
      "processResult": {
         "command": "vim-cmd vmsvc/get.snapshotinfo 4",
         "processExitCode": 0,
         "stdoutLines": [
            "(vim.vm.SnapshotInfo) {",
            "   currentSnapshot = 'vim.vm.Snapshot:4-snapshot-9', ",
            "   rootSnapshotList = (vim.vm.SnapshotTree) [",
            "      (vim.vm.SnapshotTree) {",
            "         snapshot = 'vim.vm.Snapshot:4-snapshot-1', ",
            "         vm = 'vim.VirtualMachine:4', ",
            "         name = \"scale-73_base_snapshot\", ",
            "         description = \"\", ",
            "         id = 1, ",
            "         createTime = \"2016-03-10T02:49:59.79509Z\", ",
            "         state = \"poweredOff\", ",
            "         quiesced = false, ",
            "         backupManifest = <unset>, ",
            "         childSnapshotList = (vim.vm.SnapshotTree) [",
            "            (vim.vm.SnapshotTree) {",
            "               snapshot = 'vim.vm.Snapshot:4-snapshot-7', ",
            "               vm = 'vim.VirtualMachine:4', ",
            "               name = \"readyForInstallation\", ",
            "               description = \"\", ",
            "               id = 7, ",
            "               createTime = \"2016-05-19T21:53:00.147784Z\", ",
            "               state = \"poweredOff\", ",
            "               quiesced = false, ",
            "               backupManifest = <unset>, ",
            "               replaySupported = false, ",
            "            }, ",
            "            (vim.vm.SnapshotTree) {",
            "               snapshot = 'vim.vm.Snapshot:4-snapshot-8', ",
            "               vm = 'vim.VirtualMachine:4', ",
            "               name = \"readyForInstallation\", ",
            "               description = \"\", ",
            "               id = 8, ",
            "               createTime = \"2016-05-20T00:35:56.146073Z\", ",
            "               state = \"poweredOff\", ",
            "               quiesced = false, ",
            "               backupManifest = <unset>, ",
            "               replaySupported = false, ",
            "            }, ",
            "            (vim.vm.SnapshotTree) {",
            "               snapshot = 'vim.vm.Snapshot:4-snapshot-9', ",
            "               vm = 'vim.VirtualMachine:4', ",
            "               name = \"javaInstalled\", ",
            "               description = \"\", ",
            "               id = 9, ",
            "               createTime = \"2016-05-20T00:48:27.434889Z\", ",
            "               state = \"poweredOff\", ",
            "               quiesced = false, ",
            "               backupManifest = <unset>, ",
            "               replaySupported = false, ",
            "            }",
            "         ], ",
            "         replaySupported = false",
            "      }",
            "   ]",
            "}",
            ""
         ],
         "stderrLines": [
            ""
         ],
         "shellInvocationError": null
      }
   },
   {
      "host": "10.10.99.70",
      "processResult": {
         "command": "vim-cmd vmsvc/get.snapshotinfo 5",
         "processExitCode": 0,
         "stdoutLines": [
            "(vim.vm.SnapshotInfo) {",
            "   currentSnapshot = 'vim.vm.Snapshot:5-snapshot-9', ",
            "   rootSnapshotList = (vim.vm.SnapshotTree) [",
            "      (vim.vm.SnapshotTree) {",
            "         snapshot = 'vim.vm.Snapshot:5-snapshot-1', ",
            "         vm = 'vim.VirtualMachine:5', ",
            "         name = \"scale-74_base_snapshot\", ",
            "         description = \"\", ",
            "         id = 1, ",
            "         createTime = \"2016-03-10T02:50:19.018273Z\", ",
            "         state = \"poweredOff\", ",
            "         quiesced = false, ",
            "         backupManifest = <unset>, ",
            "         childSnapshotList = (vim.vm.SnapshotTree) [",
            "            (vim.vm.SnapshotTree) {",
            "               snapshot = 'vim.vm.Snapshot:5-snapshot-7', ",
            "               vm = 'vim.VirtualMachine:5', ",
            "               name = \"readyForInstallation\", ",
            "               description = \"\", ",
            "               id = 7, ",
            "               createTime = \"2016-05-19T21:53:00.175717Z\", ",
            "               state = \"poweredOff\", ",
            "               quiesced = false, ",
            "               backupManifest = <unset>, ",
            "               replaySupported = false, ",
            "            }, ",
            "            (vim.vm.SnapshotTree) {",
            "               snapshot = 'vim.vm.Snapshot:5-snapshot-8', ",
            "               vm = 'vim.VirtualMachine:5', ",
            "               name = \"readyForInstallation\", ",
            "               description = \"\", ",
            "               id = 8, ",
            "               createTime = \"2016-05-20T00:35:56.186823Z\", ",
            "               state = \"poweredOff\", ",
            "               quiesced = false, ",
            "               backupManifest = <unset>, ",
            "               replaySupported = false, ",
            "            }, ",
            "            (vim.vm.SnapshotTree) {",
            "               snapshot = 'vim.vm.Snapshot:5-snapshot-9', ",
            "               vm = 'vim.VirtualMachine:5', ",
            "               name = \"javaInstalled\", ",
            "               description = \"\", ",
            "               id = 9, ",
            "               createTime = \"2016-05-20T00:48:27.40452Z\", ",
            "               state = \"poweredOff\", ",
            "               quiesced = false, ",
            "               backupManifest = <unset>, ",
            "               replaySupported = false, ",
            "            }",
            "         ], ",
            "         replaySupported = false",
            "      }",
            "   ]",
            "}",
            ""
         ],
         "stderrLines": [
            ""
         ],
         "shellInvocationError": null
      }
   }
]
TSULLIVAN-E496-MBR13:private-spyglass tsullivan$ #here i update the config.json to snapshot id 9 for each node
TSULLIVAN-E496-MBR13:private-spyglass tsullivan$ bin/spyglass-tester cluster snapshot apply "javaInstalled" onto centos6.5
vim-cmd vmsvc/snapshot.revert 3 9 0
vim-cmd vmsvc/snapshot.revert 4 9 0
vim-cmd vmsvc/snapshot.revert 5 9 0
vim-cmd vmsvc/power.on 3
vim-cmd vmsvc/power.on 4
vim-cmd vmsvc/power.on 5
[
   {
      "host": "10.10.99.70",
      "processResult": {
         "command": "vim-cmd vmsvc/power.on 3",
         "processExitCode": 0,
         "stdoutLines": [
            "Powering on VM:",
            ""
         ],
         "stderrLines": [
            ""
         ],
         "shellInvocationError": null
      }
   },
   {
      "host": "10.10.99.70",
      "processResult": {
         "command": "vim-cmd vmsvc/power.on 4",
         "processExitCode": 0,
         "stdoutLines": [
            "Powering on VM:",
            ""
         ],
         "stderrLines": [
            ""
         ],
         "shellInvocationError": null
      }
   },
   {
      "host": "10.10.99.70",
      "processResult": {
         "command": "vim-cmd vmsvc/power.on 5",
         "processExitCode": 0,
         "stdoutLines": [
            "Powering on VM:",
            ""
         ],
         "stderrLines": [
            ""
         ],
         "shellInvocationError": null
      }
   }
]
TSULLIVAN-E496-MBR13:private-spyglass tsullivan$ ssh root@10.10.99.72
root@10.10.99.72's password:
Last login: Thu May 19 17:46:44 2016 from 172.30.1.208
[root@scale-72 ~]# ls -al /usr/lib/jvm/jre-1.7.0-openjdk.x86_64/bin/java
-rwxr-xr-x 1 root root 5352 Apr 21 06:51 /usr/lib/jvm/jre-1.7.0-openjdk.x86_64/bin/java
[root@scale-72 ~]# java
Usage: java [-options] class [args...]
           (to execute a class)
   or  java [-options] -jar jarfile [args...]
           (to execute a jar file)
where options include:
    -d32          use a 32-bit data model if available
    -d64          use a 64-bit data model if available
    -server       to select the "server" VM
                  The default VM is server,
                  because you are running on a server-class machine.


    -cp <class search path of directories and zip/jar files>
    -classpath <class search path of directories and zip/jar files>
                  A : separated list of directories, JAR archives,
                  and ZIP archives to search for class files.
    -D<name>=<value>
                  set a system property
    -verbose:[class|gc|jni]
                  enable verbose output
    -version      print product version and exit
    -version:<value>
                  require the specified version to run
    -showversion  print product version and continue
    -jre-restrict-search | -no-jre-restrict-search
                  include/exclude user private JREs in the version search
    -? -help      print this help message
    -X            print help on non-standard options
    -ea[:<packagename>...|:<classname>]
    -enableassertions[:<packagename>...|:<classname>]
                  enable assertions with specified granularity
    -da[:<packagename>...|:<classname>]
    -disableassertions[:<packagename>...|:<classname>]
                  disable assertions with specified granularity
    -esa | -enablesystemassertions
                  enable system assertions
    -dsa | -disablesystemassertions
                  disable system assertions
    -agentlib:<libname>[=<options>]
                  load native agent library <libname>, e.g. -agentlib:hprof
                  see also, -agentlib:jdwp=help and -agentlib:hprof=help
    -agentpath:<pathname>[=<options>]
                  load native agent library by full pathname
    -javaagent:<jarpath>[=<options>]
                  load Java programming language agent, see java.lang.instrument
    -splash:<imagepath>
                  show splash screen with specified image
See http://www.oracle.com/technetwork/java/javase/documentation/index.html for more details.